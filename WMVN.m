function dydt=WMVN(t,y,N,M,G,A,g)
dydt=zeros(4*M+2*N,1);
for i=1:M
    dydt(i)=1/2 * sqrt( g / sqrt( y(2*M+i).^2 + y(3*M+i).^2) ) * y(2*M+i)./...
   sqrt( y(2*M+i).^2 + y(3*M+i).^2 ) + Um(G, y(4*M+1:4*M+N) , y(4*M+N+1:4*M+2*N),...
   y(i) , y(M+i) );
    dydt(M+i)=1/2 * sqrt( g / sqrt(y(2*M+i).^2 + y(3*M+i).^2) ) * y(3*M+i)./...
   sqrt( y(2*M+i).^2 + y(3*M+i).^2 ) + Vm(G , y(4*M+1:4*M+N), y(4*M+N+1:4*M+2*N),...
   y(i) , y(M+i));
   dydt(2*M+i) = -y(2*M+i) * dUmdx(G , y(4*M+1:4*M+N) ,y(4*M+N+1:4*M+2*N),...
   y(i) , y(M+i)) - y(3*M+i) * dVmdx(G, y(4*M+1:4*M+N), y(4*M+N+1:4*M+2*N),...
   y(i) , y(M+i));
   dydt(3*M+i) = -y(2*M+i) * dUmdy(G, y(4*M+1:4*M+N), y(4*M+N+1:4*M+2*N),...
   y(i) , y(M+i)) - y(3*M+i) * dVmdy(G, y(4*M+1:4*M+N), y(4*M+N+1:4*M+2*N),...
   y(i), y(M+i));
end
for i=1:N
   dydt(4*M+i)=Um(G , y(4*M+1:4*M+N) ,y(4*M+N+1:4*M+2*N),...
   y(4*M+i), y(4*M+N+i)) - dPsidy(A, y(1:M),...
   y(M+1:2*M), y(4*M+i), y(4*M+N+i), y(2*M+1:3*M), y(3*M+1:4*M));
   dydt(4*M+N+i)= Vm(G, y(4*M+1:4*M+N), y(4*M+N+1:4*M+2*N),...
   y(4*M+i), y(4*M+N+i))+ dPsidx(A, y(1:M),...
   y(M+1:2*M), y(4*M+i), y(4*M+N+i), y(2*M+1:3*M), y(3*M+1:4*M));
end
